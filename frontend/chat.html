<!DOCTYPE html>
<html lang="th">
<!--
    # AI Robot Guide - ‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô
    ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ä‡∏ó - ‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô
-->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô - AI Guide ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô">

    <title>‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô - AI Guide</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/chat.css">
</head>

<body class="page-with-navbar">

    <!-- NAVBAR -->
    <nav class="navbar">
        <a href="index.html" class="navbar-brand">
            ü§ñ ‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô
        </a>

        <button class="navbar-toggle" id="navbar-toggle" aria-label="Toggle menu">
            ‚ò∞
        </button>

        <div class="navbar-menu" id="navbar-menu">
            <a href="index.html" class="navbar-link">
                <span class="icon">üè†</span>
                <span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
            </a>
            <a href="places.html" class="navbar-link">
                <span class="icon">üìç</span>
                <span>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà</span>
            </a>
            <a href="chat.html" class="navbar-link active">
                <span class="icon">üí¨</span>
                <span>‡∏û‡∏π‡∏î‡∏Ñ‡∏∏‡∏¢</span>
            </a>
            <a href="about.html" class="navbar-link">
                <span class="icon">‚ÑπÔ∏è</span>
                <span>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö</span>
            </a>
        </div>

        <div class="navbar-actions">
            <button class="navbar-settings" id="btn-settings" title="‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤">
                ‚öôÔ∏è
            </button>
        </div>
    </nav>

    <!-- CHAT PAGE -->
    <main class="chat-page">

        <!-- Chat Header -->
        <header class="chat-header">
            <div class="chat-avatar">ü§ñ</div>
            <div class="chat-info">
                <h2>‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô</h2>
                <span class="chat-status">‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
            </div>
        </header>

        <!-- Messages -->
        <div class="chat-messages" id="chat-messages">

            <!-- Bot Message -->
            <div class="message message-bot">
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <p class="message-text">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞! ‡∏î‡∏¥‡∏â‡∏±‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏∞
                        üèîÔ∏è</p>
                    <span class="message-time">14:05</span>
                </div>
            </div>

            <div class="message message-bot">
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <p class="message-text">‡∏û‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∞? ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥?</p>
                    <span class="message-time">14:05</span>
                </div>
            </div>

        </div>

        <!-- Input Area -->
        <div class="chat-input-area">
            <div class="chat-input-wrapper">
                <input type="text" id="chat-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." autocomplete="off">
            </div>
            <button class="chat-action-btn btn-voice" id="btn-voice" title="‡∏û‡∏π‡∏î">
                üé§
            </button>
            <button class="chat-action-btn btn-send" id="btn-send" title="‡∏™‡πà‡∏á">
                üì§
            </button>
        </div>

    </main>

    <!-- JavaScript -->
    <script type="module">
        import { $, on } from './js/utils/dom.js';
        import { api } from './js/api/client.js';

        // State
        let isListening = false;

        // Elements
        const messagesContainer = $('#chat-messages');
        const chatInput = $('#chat-input');
        const btnSend = $('#btn-send');
        const btnVoice = $('#btn-voice');

        // Navbar Toggle
        const toggle = $('#navbar-toggle');
        const menu = $('#navbar-menu');
        if (toggle && menu) {
            on(toggle, 'click', () => menu.classList.toggle('open'));
        }

        // Add Message
        function addMessage(text, sender = 'bot') {
            const now = new Date();
            const time = now.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });

            const messageDiv = document.createElement('div');
            messageDiv.className = `message message-${sender}`;
            messageDiv.innerHTML = `
                <div class="message-avatar">${sender === 'bot' ? 'ü§ñ' : 'üë§'}</div>
                <div class="message-content">
                    <p class="message-text">${text}</p>
                    <span class="message-time">${time}</span>
                </div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Add Typing Indicator
        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message message-bot';
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <span></span><span></span><span></span>
                    </div>
                </div>
            `;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTyping() {
            const typing = $('#typing-indicator');
            if (typing) typing.remove();
        }

        // Send Message
        async function sendMessage() {
            const text = chatInput.value.trim();
            if (!text) return;

            // Add user message
            addMessage(text, 'user');
            chatInput.value = '';

            // Show typing
            showTyping();

            // TODO: Send to backend
            // const response = await api.post('/chat', { message: text });

            // Simulate response
            setTimeout(() => {
                hideTyping();
                addMessage('‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Ñ‡πà‡∏∞! ‡∏ô‡πâ‡∏≠‡∏á‡∏ô‡πà‡∏≤‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ô‡∏∞‡∏Ñ‡∏∞... üîç');
            }, 1500);
        }

        // Voice Button
        function toggleVoice() {
            isListening = !isListening;
            btnVoice.classList.toggle('listening', isListening);

            if (isListening) {
                console.log('üé§ Start listening...');
                // TODO: Start STT
            } else {
                console.log('üé§ Stop listening');
                // TODO: Stop STT
            }
        }

        // Event Bindings
        if (btnSend) on(btnSend, 'click', sendMessage);
        if (chatInput) {
            on(chatInput, 'keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
        }
        if (btnVoice) on(btnVoice, 'click', toggleVoice);

        // Init
        console.log('üí¨ ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ä‡∏ó');
    </script>
</body>

</html>