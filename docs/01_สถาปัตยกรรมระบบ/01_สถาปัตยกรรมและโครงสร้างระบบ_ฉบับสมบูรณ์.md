# üèõÔ∏è ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö (System Architecture & Structure Bible) - AI Robot Guide

‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ **"‡∏Ñ‡∏±‡∏°‡∏†‡∏µ‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å" (Master Document)** ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ **AI Robot Guide ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô** ‡πÅ‡∏•‡∏∞‡πÅ‡∏ú‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏™‡∏π‡πà **Universal AI-PR Platform** ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå

---

## 1. ‡∏ß‡∏¥‡∏™‡∏±‡∏¢‡∏ó‡∏±‡∏®‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ (Vision & Capabilities)

### 1.1 Vision: "From Local Guide to Universal Platform"
‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ "‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå‡∏ô‡∏≥‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏ô‡πà‡∏≤‡∏ô" ‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô **"Platform-as-a-Service (PaaS)"** ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏´‡πâ ‡πÉ‡∏Ñ‡∏£‡∏Å‡πá‡πÑ‡∏î‡πâ (‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ, ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤, ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£) ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á AI ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡πà‡∏≤‡∏á‡πÇ‡∏Ñ‡∏•‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞" ‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢‡πÜ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î

### 1.2 ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Current Features)
*   **Interactive AI Avatar:** ‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå 3D ‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏±‡∏ö‡∏õ‡∏≤‡∏Å‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏π‡∏î (Lip-Sync) ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡πÑ‡∏î‡πâ (GSAP Engine).
*   **Voice-First Experience:** ‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå (Groq Whisper + EdgeTTS Streaming) Latency ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ.
*   **Dual-Brain RAG:** ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≠‡∏á‡∏Ñ‡∏π‡πà‡∏Ç‡∏ô‡∏≤‡∏ô:
    *   **Fast Brain (Llama 3 @ Groq):** ‡∏ï‡∏≠‡∏ö‡πÇ‡∏ï‡πâ‡∏ö‡∏ó‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (Small Talk) ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.
    *   **Deep Brain (Gemini 2.5):** ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å.
*   **Hybrid Search:** ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á Keyword Search (Mongo) ‡πÅ‡∏•‡∏∞ Semantic Vector Search (Qdrant) ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ö **Reranker**.
*   **Smart Navigation:** ‡∏Ñ‡πç‡∏≤‡∏ô‡∏ß‡∏ì‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏ó‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.
*   **Entertainment:** ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏à‡∏≤‡∏Å YouTube ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡πÑ‡∏î‡πâ.

---

## 2. ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡∏£‡∏∞‡∏ö‡∏ö (System Architecture)

‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏ö‡∏ö **Hybrid Intelligence Optimization** ‡∏ó‡∏µ‡πà‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á Frontend (Edge Computing) ‡πÅ‡∏•‡∏∞ Backend (Cloud AI) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢
- **Frontend (The Body & Instinct):** ‡∏°‡∏µ‡∏™‡∏°‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (Frontend Director) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢‡πÜ, ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏ó‡πà‡∏≤‡∏ó‡∏≤‡∏á, ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Real-time Inputs
- **Backend (The Deep Brain):** ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô, RAG, ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏´‡∏≤‡∏®‡∏≤‡∏•

![System Architecture](https://mermaid.ink/img/Z3JhcGggVEQKICAgIFVzZXIoKCJVc2VyIikpCiAgICAKICAgIHN1YmdyYXBoIEZyb250ZW5kIFsiRnJvbnRlbmQgTGF5ZXIgKFdlYiBDbG91ZCAvIEVkZ2UpIl0KICAgICAgICBVSVsiV2ViIFVJIChDaGF0L0F2YXRhcikiXQogICAgICAgIERpcmVjdG9yWyJGcm9udGVuZCBEaXJlY3RvciAoTG9jYWwgQnJhaW4pIl0KICAgICAgICBXU19DbGllbnRbIldlYlNvY2tldCBDbGllbnQiXQogICAgICAgIEdTQVBbIkdTQVAgQW5pbWF0aW9uIEVuZ2luZSAoQXZhdGFyKSJdCiAgICAgICAgCiAgICAgICAgVXNlciA8LS0-IHxJbnRlcmFjdHwgVUkKICAgICAgICBVSSA8LS0-IHxEZWNpZGV8IERpcmVjdG9yCiAgICAgICAgRGlyZWN0b3IgLS0-IHxMb2NhbCBBY3Rpb258IFVJCiAgICAgICAgRGlyZWN0b3IgLS0-IHxDb21wbGV4IFF1ZXJ5fCBXU19DbGllbnQKICAgICAgICBVSSA8LS0-IHxBbmltYXRlc3wgR1NBUAogICAgICAgIFVJIDwtLT4gfFN0cmVhbSBBdWRpb3wgV1NfQ2xpZW50CiAgICBlbmQKICAgIAogICAgc3ViZ3JhcGggQmFja2VuZCBbIkJhY2tlbmQgTGF5ZXIgKFB5dGhvbiAzLjEyIC8gRmFzdEFQSSkiXQogICAgICAgIFdTX1NlcnZlclsiV2ViU29ja2V0IEVuZHBvaW50ICgvd3MpIl0KICAgICAgICBSb3V0ZXJ7IkludGVudCBSb3V0ZXIifQogICAgICAgIAogICAgICAgIHN1YmdyYXBoIFNlcnZpY2VzIFsiQ29yZSBTZXJ2aWNlcyJdCiAgICAgICAgICAgIFNwZWVjaFsiU3BlZWNoIEhhbmRsZXIgKFdoaXNwZXIvVFRTKSJdCiAgICAgICAgICAgIFJBR1siUkFHIE9yY2hlc3RyYXRvciAoQnJhaW4pIl0KICAgICAgICAgICAgTmF2WyJOYXZpZ2F0aW9uIFNlcnZpY2UiXQogICAgICAgICAgICBJTUdbIkltYWdlIFNlcnZpY2UiXQogICAgICAgICAgICBRdWV1ZVsiUmVkaXMgUXVldWUgUHJvZHVjZXIiXQogICAgICAgIGVuZAogICAgICAgIAogICAgICAgIHN1YmdyYXBoIEFJX0JyYWluIFsiQUkgTW9kZWxzIl0KICAgICAgICAgICAgTExKWyJMbGFtYS0zLjMgKEdyb3EpIl0KICAgICAgICAgICAgR0VNWyJHZW1pbmkgMi41IChHb29nbGUpIl0KICAgICAgICAgICAgVkRCX01vZGVsWyJFbWJlZGRpbmcgTW9kZWwgKEU1LUxhcmdlKSJdCiAgICAgICAgICAgIFJlcmFua1siQ3Jvc3MtRW5jb2RlciBSZXJhbmtlciJdCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgV1NfQ2xpZW50IDwtLT4gfEpTT04vQmluYXJ5fCBXU19TZXJ2ZXIKICAgICAgICBXU19TZXJ2ZXIgLS0-IFNwZWVjaAogICAgICAgIFNwZWVjaCAtLT4gfFRleHQgUXVlcnl8IFJBRwogICAgICAgIFJBRyAtLT4gUm91dGVyCiAgICAgICAgCiAgICAgICAgUm91dGVyIC0tPiB8U2ltcGxlfCBMTEoKICAgICAgICBSb3V0ZXIgLS0-IHxDb21wbGV4fCBHRU0KICAgICAgICBSb3V0ZXIgLS0-IHxSZXRyaWV2YWx8IFZEQl9Nb2RlbAogICAgICAgIAogICAgICAgIFZEQl9Nb2RlbCAtLT4gUkFHCiAgICAgICAgUkFHIC0tPiBSZXJhbmsKICAgICAgICBSQUcgLS0-IHxBY3Rpb24vUmVzdWx0fCBXU19TZXJ2ZXIKICAgIGVuZAogICAgCiAgICBzdWJncmFwaCBEYXRhIFsiRGF0YSAmIEluZnJhc3RydWN0dXJlIl0KICAgICAgICBNb25nb1soIk1vbmdvREIgKERhdGEvTG9ncykiKV0KICAgICAgICBRZHJhbnRbKCJRZHJhbnQgKFZlY3RvcnMpIildCiAgICAgICAgUmVkaXNbKCJSZWRpcyAoTWVzc2FnZSBRdWV1ZSkiKV0KICAgICAgICBTaGVldHNbIkdvb2dsZSBTaGVldHMgKEFkbWluIFN5bmMpIl0KICAgICAgICAKICAgICAgICBSQUcgLS0-IE1vbmdvCiAgICAgICAgVkRCX01vZGVsIDwtLT4gUWRyYW50CiAgICAgICAgU2VydmljZXMgLS0-IFJlZGlzCiAgICBlbmQK)

### 2.1 ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°
1.  **Centralized Logic:** ‡∏£‡∏ß‡∏° Logic ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà Python Backend (`/Back-end`) ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô.
2.  **Streaming First:** ‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ Stream ‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô‡∏ô‡πâ‡∏≥‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏õ‡∏•‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ (TTS Streaming).
3.  **Modular Design:** ‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô Speech, RAG, ‡πÅ‡∏•‡∏∞ Database ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ñ‡∏≠‡∏î‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡πÄ‡∏ä‡πà‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Gemini ‡πÄ‡∏õ‡πá‡∏ô GPT-4) ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏≠‡∏∑‡πà‡∏ô.

---

## 3. ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå (Project Structure)

### üìÇ Root Directory
*   `frontend`: **Frontend Application** (HTML/JS/CSS)
    *   `index.html`: Main UI Entry Point (‡∏£‡∏ß‡∏° Chat Interface)
    *   `archive/chat.html`: (Archived) Old Chat Interface
    *   `js/app.js`: **Core Application Bootstrapper**
    *   `js/services/`: Services (Chat, Alert, Avatar)
    *   `js/modules/`: Business Modules (Language, State, UI)
    *   `js/utils/`: Shared Utilities
*   `avatar`: **Modular Avatar System** (3D Model & GSAP)
    *   `behaviors/`: Avatar behaviors logic
    *   `index.html`: Avatar iframe entry point
*   `Back-end`: **Backend Application** (Python)
    *   `api/main.py`: Entry point ‡∏Ç‡∏≠‡∏á server (FastAPI)
    *   `core/`: Business Logic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    *   `core/ai_models/`: Modules ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö RAG, Speech, LLM Handlers
    *   `core/hardware/`: Hardware Control Logic
    *   `workers/`: Background Workers (‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å Redis)
*   `hardware`: **Standalone Hardware Scripts** (Arduino/Serial)
*   `docker-compose.yml`: ‡πÑ‡∏ü‡∏•‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î Infrastructure (Mongo, Qdrant, Redis)
*   `start_all.sh`: ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (One-click start)

### üìÇ ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô Backend
*   **`core/ai_models/rag_orchestrator.py`:** "‡∏°‡∏±‡∏ô‡∏™‡∏°‡∏≠‡∏á" ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö
    *   ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Flow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô: ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° -> ‡∏ï‡∏£‡∏ß‡∏à Intent -> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö -> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log.
    *   ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ **Self-Correction Logic**: ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ï‡πà‡∏≥ (Confidence < 0.45) ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏≠‡∏ö.
*   **`core/ai_models/speech_handler.py`:** "‡∏õ‡∏≤‡∏Å‡πÅ‡∏•‡∏∞‡∏´‡∏π"
    *   **STT:** ‡πÉ‡∏ä‡πâ Groq Whisper (Cloud) ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏ñ‡πâ‡∏≤‡∏•‡πà‡∏°‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ä‡πâ Local Faster-Whisper.
    *   **TTS:** ‡πÉ‡∏ä‡πâ Edge-TTS ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏ö‡∏ö Streaming (yield bytes) ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.
*   **`core/database/qdrant_manager.py`:** "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß"
    *   ‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏≤‡∏£‡∏ù‡∏≤‡∏Å-‡∏ñ‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ (Vectors) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£ Search ‡πÅ‡∏ö‡∏ö Semantic.

---

## 4. ‡πÄ‡∏à‡∏≤‡∏∞‡∏•‡∏∂‡∏Å‡∏£‡∏∞‡∏ö‡∏ö: ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á RAG Pipeline (The Brain)

‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡∏Ç‡∏≠‡∏á AI ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° (‡πÄ‡∏ä‡πà‡∏ô "‡∏ß‡∏±‡∏î‡∏†‡∏π‡∏°‡∏¥‡∏ô‡∏ó‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏´‡∏£‡πà"):

1.  **Input Analysis (‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå):**
    *   `QueryInterpreter` ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏à‡∏ï‡∏ô‡∏≤ (Intent) ‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏±‡∏î Entity (‡πÄ‡∏ä‡πà‡∏ô "‡∏ß‡∏±‡∏î‡∏†‡∏π‡∏°‡∏¥‡∏ô‡∏ó‡∏£‡πå").
2.  **Retrieval (‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤):**
    *   **Direct Search:** ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏á‡πÜ ‡πÉ‡∏ô MongoDB (‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ 100% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞).
    *   **Vector Search:** ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á‡πÉ‡∏ô Qdrant.
    *   **Trending:** ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡∏°‡∏≤‡∏ú‡∏™‡∏°‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÜ.
3.  **Reranking (‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö):**
    *   ‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• **Cross-Encoder** ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà (Re-score).
    *   ‡∏î‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏ä‡∏∑‡πà‡∏≠ (Direct Match) ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏° (Trending) ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î.
4.  **Generation (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö):**
    *   ‡∏™‡πà‡∏á Context ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (Top 5) ‡πÉ‡∏´‡πâ LLM (Gemini/Llama).
    *   Prompt Engineering ‡∏Å‡∏≥‡∏Å‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ï‡∏≠‡∏ö‡∏™‡∏±‡πâ‡∏ô ‡∏Å‡∏£‡∏∞‡∏ä‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥.
5.  **Audit (‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö):**
    *   ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô Confidence ‡∏´‡∏≤‡∏Å‡∏ï‡πà‡∏≥‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏à‡∏∞‡∏ï‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÅ‡∏ó‡∏ô (Self-Correction).

---

## 5. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Blocking I/O ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏ß (Performance & Queue Guide)

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ I/O ‡πÅ‡∏•‡∏∞ Message Queue ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

### 5.1 ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Blocking I/O ‡πÉ‡∏ô FastAPI
‡πÉ‡∏ô Python `async def`, ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Code ‡∏ó‡∏µ‡πà‡∏Å‡∏¥‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Database ‡πÅ‡∏ö‡∏ö Sync, ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏û) ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ `await`, ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞ **"‡∏Ñ‡πâ‡∏≤‡∏á" (Block)** ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏±‡∏ö Request ‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:**
1.  **‡πÉ‡∏ä‡πâ Async Library:** ‡πÄ‡∏ä‡πà‡∏ô `motor` ‡πÅ‡∏ó‡∏ô `pymongo` (‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ `pymongo` ‡πÅ‡∏ï‡πà‡∏£‡∏±‡∏ô‡πÉ‡∏ô Threadpool).
2.  **run_in_threadpool:** ‡∏´‡∏≤‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á Library ‡πÅ‡∏ö‡∏ö Sync ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ:
    ```python
    from fastapi.concurrency import run_in_threadpool
    # ‡∏¢‡πâ‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡∏±‡∏Å‡πÑ‡∏õ‡∏ó‡∏≥‡πÉ‡∏ô Thread ‡πÅ‡∏¢‡∏Å ‡πÑ‡∏°‡πà‡∏Ç‡∏ß‡∏≤‡∏á Main Loop
    result = await run_in_threadpool(sync_function, arg1, arg2)
    ```

### 5.2 ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏ß‡∏î‡πâ‡∏ß‡∏¢ Redis (Task Queue Architecture)
‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ô‡∏≤‡∏ô‡∏°‡∏≤‡∏Å (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πà‡∏≤‡∏ß‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô, ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á) ‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ‡πÇ‡∏°‡πÄ‡∏î‡∏• **Producer-Consumer**:

![Redis Queue](https://mermaid.ink/img/c2VxdWVuY2VEaWFncmFtCiAgICBwYXJ0aWNpcGFudCBXZWJob29rIGFzICJBUEkgR2F0ZXdheSAoUHJvZHVjZXIpIgogICAgcGFydGljaXBhbnQgUmVkaXMgYXMgIlJlZGlzIExpc3QgKFF1ZXVlKSIKICAgIHBhcnRpY2lwYW50IFdvcmtlciBhcyAiQmFja2dyb3VuZCBXb3JrZXIgKENvbnN1bWVyKSIKICAgIAogICAgV2ViaG9vay0-PlJlZGlzOiAxLiBMUFVTSCAo4Lid4Liy4LiB4LiH4Liy4LiZ4LmE4Lin4LmJ4LiB4LmI4Lit4LiZKQogICAgV2ViaG9vay0tPj5Vc2VyOiAyLiDguJXguK3guJrguIHguKXguLHguJrguJfguLHguJnguJfguLUgKOC5hOC4oeC5iOC4o-C4reC5gOC4quC4o-C5h-C4iCkKICAgIAogICAgbG9vcCBCYWNrZ3JvdW5kCiAgICAgICAgV29ya2VyLT4-UmVkaXM6IDMuIEJSUE9QICjguKPguK3guKPguLHguJrguIfguLLguJkpCiAgICAgICAgUmVkaXMtLT4-V29ya2VyOiA0LiDguYTguJTguYnguKPguLHguJrguIfguLLguJkgKEpTT04pCiAgICAgICAgV29ya2VyLT4-V29ya2VyOiA1LiDguJvguKPguLDguKHguKfguKXguJzguKXguKvguJnguLHguIHguYYKICAgIGVuZAo=)

*   **Producer:** FastAPI ‡∏£‡∏±‡∏ö Request -> ‡πÇ‡∏¢‡∏ô JSON ‡∏•‡∏á Redis -> ‡∏à‡∏ö‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.
*   **Consumer:** Script ‡πÅ‡∏¢‡∏Å (`workers/worker_line.py`) ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏´‡∏¢‡∏¥‡∏ö‡∏á‡∏≤‡∏ô‡∏à‡∏≤‡∏Å Redis ‡∏°‡∏≤‡∏ó‡∏≥‡∏ó‡∏µ‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô.

---

## 6. ‡πÅ‡∏ú‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (Future Roadmap)

1.  **Multi-Tenancy:** ‡∏õ‡∏£‡∏±‡∏ö Database ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ô (‡πÅ‡∏¢‡∏Å Knowledge Base ‡∏Ç‡∏≠‡∏á‡πÉ‡∏Ñ‡∏£‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô).
2.  **Authentication:** ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö Login ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á AI.
3.  **Advanced Analytics:** ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏µ‡πà‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏∂‡πâ‡∏ô.

---
*‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏ô‡∏µ‡πâ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠: December 2025*
